{"id":329895509,"lang":"python3","time":"1 year, 2 months","timestamp":1587825756,"status_display":"Accepted","runtime":"1352 ms","url":"/submissions/detail/329895509/","is_pending":"Not Pending","title":"Count Servers that Communicate","memory":"15.4 MB","code":"class UnionFind:\n    def __init__(self, node_list):\n        # type(node) == tuple\n        self.node2par = {node: node for node in node_list}\n        self.rank = {node: 0 for node in node_list}\n    \n    def find_par(self, node):\n        if node == self.node2par[node]:\n            return node\n        else:\n            res = self.node2par[node]\n            return self.find_par(res)\n    \n    def unite(self, x, y):\n        x, y = self.find_par(x), self.find_par(y)\n        if x == y:\n            return\n        if self.rank[x] > self.rank[y]:\n            self.node2par[y] = x\n        elif self.rank[x] < self.rank[y]:\n            self.node2par[x] = y\n        else:\n            self.node2par[y] = x\n            self.rank[x] += 1\n       \n        \nclass Solution:\n    def countServers(self, grid):\n        R, C = len(grid), len(grid[0])\n        node_list = []\n        for r in range(R):\n            for c in range(C):\n                if grid[r][c] == 1:\n                    node_list.append((r, c))\n        \n        uf = UnionFind(node_list)\n        for r in range(R):\n            for c in range(C):\n                if grid[r][c] == 1:\n                    for y in range(R):\n                        if grid[y][c] == 1:\n                            uf.unite((r, c), (y, c))\n                    for x in range(C):\n                        if grid[r][x] == 1:\n                            uf.unite((r, c), (r, x))\n        \n        for node in uf.rank.keys():\n            par_node = uf.find_par(node)\n            rank = uf.rank[par_node]\n            uf.rank[node] = rank\n            \n        ans = 0\n        for val in uf.rank.values():\n            if val != 0:\n                ans += 1\n        return ans\n        \n        ","compare_result":"1111111111111111111111111111111111111111111111111111111","title_slug":"count-servers-that-communicate"}